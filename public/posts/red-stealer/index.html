<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Red Stealer | EESWEBLOG</title>
<meta name="keywords" content="forensics, VirusTotal, MalwareBazaar, ThreatFox, cyberdefenders">
<meta name="description" content="Red Stealer

Link: https://cyberdefenders.org/blueteam-ctf-challenges/red-stealer/

Scenario
You are part of the Threat Intelligence team in the SOC (Security Operations Center). An executable file has been discovered on a colleague&rsquo;s computer, and it&rsquo;s suspected to be linked to a Command and Control (C2) server, indicating a potential malware infection.Your task is to investigate this executable by analyzing its hash. The goal is to gather and analyze data beneficial to other SOC members, including the Incident Response team, to respond to this suspicious behavior efficiently.">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/red-stealer/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css" integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF&#43;13Dyqob6ASlTrTye8=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/red-stealer/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="EESWEBLOG (Alt + H)">EESWEBLOG</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/posts/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Red Stealer
    </h1>
    <div class="post-meta"><span title='2025-04-15 18:26:39 +0700 WIB'>April 15, 2025</span>&nbsp;·&nbsp;4 min

</div>
  </header> 
  <div class="post-content"><h1 id="red-stealer">Red Stealer<a hidden class="anchor" aria-hidden="true" href="#red-stealer">#</a></h1>
<p><img alt="redstealer" loading="lazy" src="/img/red-stealer/banner.png"></p>
<p>Link: <a href="https://cyberdefenders.org/blueteam-ctf-challenges/red-stealer/">https://cyberdefenders.org/blueteam-ctf-challenges/red-stealer/</a></p>
<hr>
<h2 id="scenario">Scenario<a hidden class="anchor" aria-hidden="true" href="#scenario">#</a></h2>
<p>You are part of the Threat Intelligence team in the SOC (Security Operations Center). An executable file has been discovered on a colleague&rsquo;s computer, and it&rsquo;s suspected to be linked to a Command and Control (C2) server, indicating a potential malware infection.Your task is to investigate this executable by analyzing its hash. The goal is to gather and analyze data beneficial to other SOC members, including the Incident Response team, to respond to this suspicious behavior efficiently.</p>
<h2 id="file-analysis">File Analysis<a hidden class="anchor" aria-hidden="true" href="#file-analysis">#</a></h2>
<hr>
<p>Given zip file containing txt files with the following information:</p>
<pre tabindex="0"><code>File Hash (SHA-256): 248FCC901AFF4E4B4C48C91E4D78A939BF681C9A1BC24ADDC3551B32768F907B

Use this hash on online threat intel platforms (e.g., VirusTotal, Hybrid Analysis) to complete the lab analysis
</code></pre><hr>
<h2 id="questions">Questions<a hidden class="anchor" aria-hidden="true" href="#questions">#</a></h2>
<h3 id="1-categorizing-malware-enables-a-quicker-and-clearer-understanding-of-its-unique-behaviors-and-attack-vectors-what-category-has-microsoft-identified-for-that-malware-in-virustotal">1. Categorizing malware enables a quicker and clearer understanding of its unique behaviors and attack vectors. What category has Microsoft identified for that malware in VirusTotal?<a hidden class="anchor" aria-hidden="true" href="#1-categorizing-malware-enables-a-quicker-and-clearer-understanding-of-its-unique-behaviors-and-attack-vectors-what-category-has-microsoft-identified-for-that-malware-in-virustotal">#</a></h3>
<p>By Search the sha256 hash on <a href="https://www.virustotal.com/gui/file/248FCC901AFF4E4B4C48C91E4D78A939BF681C9A1BC24ADDC3551B32768F907B">virustotal</a> i get the category of the malware on popular threat label section which is &ldquo;trojan&rdquo;</p>
<p><img alt="virustotal" loading="lazy" src="/img/red-stealer/q1.png"></p>
<p><strong>Answer: trojan</strong></p>
<h3 id="2-clearly-identifying-the-name-of-the-malware-file-improves-communication-among-the-soc-team-what-is-the-file-name-associated-with-this-malware">2. Clearly identifying the name of the malware file improves communication among the SOC team. What is the file name associated with this malware?<a hidden class="anchor" aria-hidden="true" href="#2-clearly-identifying-the-name-of-the-malware-file-improves-communication-among-the-soc-team-what-is-the-file-name-associated-with-this-malware">#</a></h3>
<p>By visiting Details page on virustotal, i get a lot of file name, but only &ldquo;Wextract&rdquo; is the suitable file name for the submit form.</p>
<p><img alt="virustotal" loading="lazy" src="/img/red-stealer/q2.png"></p>
<p><strong>Answer: Wextract</strong></p>
<h3 id="3-knowing-the-exact-timestamp-of-when-the-malware-was-first-observed-can-help-prioritize-response-actions-newly-detected-malware-may-require-urgent-containment-and-eradication-compared-to-older-well-documented-threats-what-is-the-utc-timestamp-of-the-malwares-first-submission-to-virustotal">3. Knowing the exact timestamp of when the malware was first observed can help prioritize response actions. Newly detected malware may require urgent containment and eradication compared to older, well-documented threats. What is the UTC timestamp of the malware&rsquo;s first submission to VirusTotal?<a hidden class="anchor" aria-hidden="true" href="#3-knowing-the-exact-timestamp-of-when-the-malware-was-first-observed-can-help-prioritize-response-actions-newly-detected-malware-may-require-urgent-containment-and-eradication-compared-to-older-well-documented-threats-what-is-the-utc-timestamp-of-the-malwares-first-submission-to-virustotal">#</a></h3>
<p>By visiting Details page on virustotal, i get the timestamp of the first submission report for the malware which is 2023-10-06 04:41:50 UTC.</p>
<p><img alt="virustotal" loading="lazy" src="/img/red-stealer/q3.png"></p>
<p><strong>Answer: 2023-10-06 04:41</strong></p>
<h3 id="4-understanding-the-techniques-used-by-malware-helps-in-strategic-security-planning-what-is-the-mitre-attck-technique-id-for-the-malwares-data-collection-from-the-system-before-exfiltration">4. Understanding the techniques used by malware helps in strategic security planning. What is the MITRE ATT&amp;CK technique ID for the malware&rsquo;s data collection from the system before exfiltration?<a hidden class="anchor" aria-hidden="true" href="#4-understanding-the-techniques-used-by-malware-helps-in-strategic-security-planning-what-is-the-mitre-attck-technique-id-for-the-malwares-data-collection-from-the-system-before-exfiltration">#</a></h3>
<p>By visiting Behavior page, i searched for collection and i get the id for the technique which is T1005</p>
<p><img alt="virustotal" loading="lazy" src="/img/red-stealer/q4.png"></p>
<p><strong>Answer: T1005</strong></p>
<h3 id="5-following-execution-which-social-media-related-domain-names-did-the-malware-resolve-via-dns-queries">5. Following execution, which social media-related domain names did the malware resolve via DNS queries?<a hidden class="anchor" aria-hidden="true" href="#5-following-execution-which-social-media-related-domain-names-did-the-malware-resolve-via-dns-queries">#</a></h3>
<p>By visiting Behavior page, if we look into http requests section we get several url and <a href="https://www.facebook.com">www.facebook.com</a> is the only one which social media platforms.</p>
<p><img alt="virustotal" loading="lazy" src="/img/red-stealer/q5.png"></p>
<p><strong>Answer: <a href="https://www.facebook.com">www.facebook.com</a></strong></p>
<h3 id="6-once-the-malicious-ip-addresses-are-identified-network-security-devices-such-as-firewalls-can-be-configured-to-block-traffic-to-and-from-these-addresses-can-you-provide-the-ip-address-and-destination-port-the-malware-communicates-with">6. Once the malicious IP addresses are identified, network security devices such as firewalls can be configured to block traffic to and from these addresses. Can you provide the IP address and destination port the malware communicates with?<a hidden class="anchor" aria-hidden="true" href="#6-once-the-malicious-ip-addresses-are-identified-network-security-devices-such-as-firewalls-can-be-configured-to-block-traffic-to-and-from-these-addresses-can-you-provide-the-ip-address-and-destination-port-the-malware-communicates-with">#</a></h3>
<p>By visiting Behavior page, if we look into memory pattern urls section we got several ip address and destination port.but the first one was suspicious because it has no DNS.</p>
<p><img alt="virustotal" loading="lazy" src="/img/red-stealer/q6.png"></p>
<p><strong>Answer: 77.91.124.55:19071</strong></p>
<h3 id="7-yara-rules-are-designed-to-identify-specific-malware-patterns-and-behaviors-using-malwarebazaar-whats-the-name-of-the-yara-rule-created-by-varp0s-that-detects-the-identified-malware">7. YARA rules are designed to identify specific malware patterns and behaviors. Using MalwareBazaar, what&rsquo;s the name of the YARA rule created by &ldquo;Varp0s&rdquo; that detects the identified malware?<a hidden class="anchor" aria-hidden="true" href="#7-yara-rules-are-designed-to-identify-specific-malware-patterns-and-behaviors-using-malwarebazaar-whats-the-name-of-the-yara-rule-created-by-varp0s-that-detects-the-identified-malware">#</a></h3>
<p>As the instructions. i go to MalwareBazaar and search for the sha256 and i got just 1 result. And if we click into the sha256 text, we will directed into the &lsquo;information&rsquo; page.</p>
<p><img alt="virustotal" loading="lazy" src="/img/red-stealer/q7-1.png"></p>
<p>and if we click the YARA (as the instructions). we will get several rule name, but only detect_Redline_Stealer is the suitable one(authored by Varp0s).</p>
<p><img alt="virustotal" loading="lazy" src="/img/red-stealer/q7-2.png"></p>
<p><strong>Answer: detect_Redline_Stealer</strong></p>
<h3 id="8-understanding-which-malware-families-are-targeting-the-organization-helps-in-strategic-security-planning-for-the-future-and-prioritizing-resources-based-on-the-threat-can-you-provide-the-different-malware-alias-associated-with-the-malicious-ip-address-according-to-threatfox">8. Understanding which malware families are targeting the organization helps in strategic security planning for the future and prioritizing resources based on the threat. Can you provide the different malware alias associated with the malicious IP address according to ThreatFox?<a hidden class="anchor" aria-hidden="true" href="#8-understanding-which-malware-families-are-targeting-the-organization-helps-in-strategic-security-planning-for-the-future-and-prioritizing-resources-based-on-the-threat-can-you-provide-the-different-malware-alias-associated-with-the-malicious-ip-address-according-to-threatfox">#</a></h3>
<p>Because ThreatFox doesnt support for sha256 search. i will use malware family instead. So, i search for the malware family and i get &ldquo;Redline&rdquo;. After that lets search that malware family at ThreatFox.</p>
<p><img alt="virustotal" loading="lazy" src="/img/red-stealer/q8-1.png"></p>
<p>by clicking the redline stealer, we will get the different malware alias which is RECORDSTEALER.</p>
<p><img alt="virustotal" loading="lazy" src="/img/red-stealer/q8-2.png"></p>
<p><strong>Answer: RECORDSTEALER</strong></p>
<h3 id="9-by-identifying-the-malwares-imported-dlls-we-can-configure-security-tools-to-monitor-for-the-loading-or-unusual-usage-of-these-specific-dlls-can-you-provide-the-dll-utilized-by-the-malware-for-privilege-escalation">9. By identifying the malware&rsquo;s imported DLLs, we can configure security tools to monitor for the loading or unusual usage of these specific DLLs. Can you provide the DLL utilized by the malware for privilege escalation?<a hidden class="anchor" aria-hidden="true" href="#9-by-identifying-the-malwares-imported-dlls-we-can-configure-security-tools-to-monitor-for-the-loading-or-unusual-usage-of-these-specific-dlls-can-you-provide-the-dll-utilized-by-the-malware-for-privilege-escalation">#</a></h3>
<p>Back into virustotal and click on Behavior, if we look at modules loaded. there is several modules. but advapi was suspicious for me because it can handle some advanced windows function</p>
<p><img alt="virustotal" loading="lazy" src="/img/red-stealer/q9.png"></p>
<p><strong>Answer: advapi32.dll</strong></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/forensics/">Forensics</a></li>
      <li><a href="http://localhost:1313/tags/virustotal/">VirusTotal</a></li>
      <li><a href="http://localhost:1313/tags/malwarebazaar/">MalwareBazaar</a></li>
      <li><a href="http://localhost:1313/tags/threatfox/">ThreatFox</a></li>
      <li><a href="http://localhost:1313/tags/cyberdefenders/">Cyberdefenders</a></li>
    </ul>
<nav class="paginav">
  <a class="next" href="http://localhost:1313/posts/reveal/">
    <span class="title">Next »</span>
    <br>
    <span>Reveal</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">EESWEBLOG</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
